# Parent CI/CD Configuration - defines common stages and includes child pipelines
image: maven:3.8-openjdk-17

variables:
  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository"
  DOCKER_DRIVER: overlay2
  SPRING_PROFILES_ACTIVE: "local"

cache:
  paths:
    - .m2/repository/

# Include child CI configurations
include:
  - local: 'analytics-service/.analytics-service-gitlab-ci.yml'

stages:
  - validate
  - build
  - package
  - test
  - deploy

# Validate project structure only
validate:
  stage: validate
  script:
    - mvn validate
  only:
    - TFMS_v1.0.0_dev
    - merge_requests

